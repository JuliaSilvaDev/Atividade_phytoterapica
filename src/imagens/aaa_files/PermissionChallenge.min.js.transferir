(window.webpackJsonpvtex_organizations_challenge_1_1_1=window.webpackJsonpvtex_organizations_challenge_1_1_1||[]).push([["PermissionChallenge"],[function(e,n){e.exports=ReactApollo},function(e,n){e.exports=React},function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getDocuments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acronym"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fields"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schema"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"where"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"page"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[{kind:"Directive",name:{kind:"Name",value:"context"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sender"},value:{kind:"StringValue",value:"vtex.organizations-challenge@1.1.1",block:!1}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"documents"},arguments:[{kind:"Argument",name:{kind:"Name",value:"acronym"},value:{kind:"Variable",name:{kind:"Name",value:"acronym"}}},{kind:"Argument",name:{kind:"Name",value:"fields"},value:{kind:"Variable",name:{kind:"Name",value:"fields"}}},{kind:"Argument",name:{kind:"Name",value:"schema"},value:{kind:"Variable",name:{kind:"Name",value:"schema"}}},{kind:"Argument",name:{kind:"Name",value:"where"},value:{kind:"Variable",name:{kind:"Name",value:"where"}}},{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"Variable",name:{kind:"Name",value:"page"}}},{kind:"Argument",name:{kind:"Name",value:"pageSize"},value:{kind:"Variable",name:{kind:"Name",value:"pageSize"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"runtimeMeta"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"StringValue",value:"ec093db54aee98d52cf4889869e55448519ddcc5787382b700373659e4276375",block:!1}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:463}};i.loc.source={body:'query getDocuments($acronym: String, $fields: [String], $schema: String, $where: String, $page: Int, $pageSize: Int) @context(sender: "vtex.organizations-challenge@1.1.1") {\n  documents(acronym: $acronym, fields: $fields, schema: $schema, where: $where, page: $page, pageSize: $pageSize) @runtimeMeta(hash: "ec093db54aee98d52cf4889869e55448519ddcc5787382b700373659e4276375") {\n    id\n    fields {\n      key\n      value\n      __typename\n    }\n    __typename\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),a[e.name.value]=n}})),e.exports=i,e.exports.getDocuments=function(e,n){var i={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var d=a[n]||new Set,l=new Set,r=new Set;for(d.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){l.has(e)||(l.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return l.forEach((function(n){var a=t(e,n);a&&i.definitions.push(a)})),i}(i,"getDocuments")},,function(e,n){e.exports=__RENDER_8_RUNTIME__},,,function(e,n){e.exports=ReactIntl},function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Profile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"customFields"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[{kind:"Directive",name:{kind:"Name",value:"context"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"StringValue",value:"private",block:!1}},{kind:"Argument",name:{kind:"Name",value:"sender"},value:{kind:"StringValue",value:"vtex.organizations-challenge@1.1.1",block:!1}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"profile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"customFields"},value:{kind:"Variable",name:{kind:"Name",value:"customFields"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"runtimeMeta"},arguments:[{kind:"Argument",name:{kind:"Name",value:"hash"},value:{kind:"StringValue",value:"92a64eda0fd01b5299452edef740bc7989f3f1abb645fdd297abbdc6a69e6086",block:!1}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"customFields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:335}};i.loc.source={body:'query Profile($customFields: String) @context(scope: "private", sender: "vtex.organizations-challenge@1.1.1") {\n  profile(customFields: $customFields) @runtimeMeta(hash: "92a64eda0fd01b5299452edef740bc7989f3f1abb645fdd297abbdc6a69e6086") {\n    email\n    customFields {\n      key\n      value\n      __typename\n    }\n    __typename\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var a={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var a=e.definitions[i];if(a.name&&a.name.value==n)return a}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var a=n.type;"NamedType"===a.kind&&i.add(a.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),a[e.name.value]=n}})),e.exports=i,e.exports.Profile=function(e,n){var i={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var d=a[n]||new Set,l=new Set,r=new Set;for(d.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){l.has(e)||(l.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return l.forEach((function(n){var a=t(e,n);a&&i.definitions.push(a)})),i}(i,"Profile")},,,function(e,n,i){"use strict";i.r(n),function(e){var n=i(3);i.p=Object(n.getPublicPath)("vtex.organizations-challenge@1.1.1");var a=Object(n.register)((function(){return i(12)}),e,"vtex.organizations-challenge@1.1.1","vtex.organizations-challenge@1.x","PermissionChallenge");a.renderHotReload,a.setupHMR}.call(this,i(5)(e))},function(e,n,i){"use strict";i.r(n);var a=i(1),t=i.n(a),d=i(4),l=i(7),r=i(0),o=i(8),s=i.n(o),m=["permissions"],u=["id","name"],c=["roleId"];var v=i(2),k=i.n(v);function f(e){var n=e.permissions,i=void 0===n?[]:n,a=e.AllowedContent,l=e.DisallowedContent,o=function(e){var n=e.permissionIds,i=Object(r.useQuery)(k.a,{skip:!((null==n?void 0:n.length)>0),variables:{acronym:"BusinessPermission",fields:u,schema:"business-permission-schema-v1"}}).data;return i&&i.documents?{userPermissionNames:i.documents.filter((function(e){return n.includes(e.id)})).map((function(e){var n,i,a;return null!==(a=null===(i=null===(n=e.fields)||void 0===n?void 0:n.find((function(e){return"name"===e.key})))||void 0===i?void 0:i.value)&&void 0!==a?a:""})).filter(Boolean)}:{userPermissionNames:null}}(function(e){var n,i,a=e.roleId,t=Object(r.useQuery)(k.a,{skip:!a,variables:{acronym:"BusinessRole",fields:m,where:"(id=".concat(a,")"),schema:"business-role-schema-v1"}}).data;if(!t||!t.documents)return{permissionIds:[]};var d=t.documents.length-1,l=null===(n=t.documents[d])||void 0===n?void 0:n.fields,o=null===(i=null==l?void 0:l.find((function(e){return"permissions"===e.key})))||void 0===i?void 0:i.value;return{permissionIds:JSON.parse(null!=o?o:"[]")}}(function(e){var n,i,a,t=e.email,d=e.organizationId,l=Object(r.useQuery)(k.a,{skip:!t||!d,variables:{acronym:"UserOrganization",schema:"user-organization-schema-v1",fields:c,where:"(email=".concat(t," AND businessOrganizationId=").concat(d,")")}}).data;if(!l||!l.documents)return{roleId:null};var o=(null===(n=null==l?void 0:l.documents)||void 0===n?void 0:n.length)-1,s=null===(i=l.documents[o])||void 0===i?void 0:i.fields;return{roleId:null===(a=null==s?void 0:s.find((function(e){return"roleId"===e.key})))||void 0===a?void 0:a.value}}(function(){var e,n,i,a=Object(r.useQuery)(s.a,{variables:{customFields:"organizationId"},ssr:!1}).data,t=null===(e=null==a?void 0:a.profile)||void 0===e?void 0:e.email,d=null===(n=null==a?void 0:a.profile)||void 0===n?void 0:n.customFields;return{email:t,organizationId:null===(i=null==d?void 0:d.find((function(e){return"organizationId"===e.key})))||void 0===i?void 0:i.value}}()))).userPermissionNames,v=!1;return o&&(v=i.some((function(e){return o.includes(e.name)}))),v?a?t.a.createElement(a,null):t.a.createElement(d.ExtensionPoint,{id:"allowed-content"}):l?t.a.createElement(l,null):t.a.createElement(d.ExtensionPoint,{id:"disallowed-content"})}var p=Object(l.defineMessages)({permissionChallengeTitle:{id:"admin/editor.challenge-permission.title"}});f.schema={title:p.permissionChallengeTitle.id,type:"object",properties:{permissions:{minItems:0,type:"array",title:"admin/editor.challenge-permission.permissions.title",items:{title:"admin/editor.challenge-permission.permissions.items.title",type:"object",properties:{name:{title:"admin/editor.challenge-permission.permissions.items.name",type:"string"}}}}}};n.default=f}],[[11,"common"]]]);