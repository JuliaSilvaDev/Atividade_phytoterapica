(window.webpackJsonpvtex_product_customizer_2_12_1=window.webpackJsonpvtex_product_customizer_2_12_1||[]).push([["ProductAssemblyOptions"],{0:function(t,e){t.exports=React},1:function(t,e){t.exports=R},10:function(t,e){t.exports=ReactIntl},19:function(t,e){t.exports=__RENDER_8_COMPONENTS__["vtex.styleguide@9.x/Button"]},24:function(t,e){t.exports=__RENDER_8_COMPONENTS__["vtex.native-types@0.x/IOMessage"]},26:function(t,e){t.exports=__RENDER_8_COMPONENTS__["vtex.product-context@0.x/ProductDispatchContext"]},29:function(t,e,n){"use strict";var r=n(0),i=n.n(r),a=n(10),u=n(5),o=n.n(u),c=n(24),l=n.n(c),s=n(19),m=n.n(s),d=n(20),p=n(1),f=n(26);function y(t){var e=Object(f.useProductDispatch)();Object(r.useEffect)((function(){var n=t.items,r=t.id,i=t.type,a=t.valuesOfInputValues,u=t.optin,o=u?Object.values(null!=n?n:{}).map(v(i)):[],c=!u||function t(e){var n,r=Object.values(null!==(n=e.items)&&void 0!==n?n:{}),i=r.reduce((function(t,e){return t+e.quantity}),0);if(!(void 0!==e.maxQuantity&&e.maxQuantity>=i&&e.minQuantity<=i||void 0===e.maxQuantity))return!1;return r.every((function(e){return!e.children||Object.values(e.children).every((function(e){return t(e)}))}))}(t);e({type:"SET_ASSEMBLY_OPTIONS",args:{groupId:r,groupItems:o,groupInputValues:u?a:{},isValid:c}})}),[t,e])}function v(t){return function(e){return Object.assign(Object.assign({},Object(p.pick)(["name","id","initialQuantity","quantity","seller"],e)),{price:e.price/100,choiceType:t,children:e.children?b(e.children):null})}}function b(t){for(var e,n={},r=0,i=Object.keys(t);r<i.length;r++){var a=i[r],u=t[a];n[a]=Object.values(null!==(e=u.items)&&void 0!==e?e:{}).map(v(u.type))}return n}var O=n(6),E=n(3),_=n(8),g=["itemContainer"],h=function(t){var e,n,r,a,u,c,l,s=t.children,m=o()(g),d=(e=Object(E.b)(),n=e.id,r=e.quantity,a=Object(O.c)(),u=a.type,c=a.path,l=Object(O.b)(),0===r&&u===_.a.SINGLE?function(){return l({type:"SET_QUANTITY",args:{itemId:n,newQuantity:1,type:_.a.SINGLE,groupPath:c}})}:u===_.a.TOGGLE?function(){return l({type:"SET_QUANTITY",args:{itemId:n,newQuantity:1===r?0:1,type:_.a.TOGGLE,groupPath:c}})}:void 0);return i.a.createElement("div",{tabIndex:0,role:"button",onClick:function(){null==d||d()},onKeyDown:function(t){var e=t.key;" "!==e&&"Enter"!==e||null==d||d()},className:"".concat(m.itemContainer," hover-bg-muted-5 bb b--muted-5 pa3 pointer")},s)},x=["productAssemblyGroupName","productAssemblyGroupNameRow","productAssemblyGroupRequiredTag"];e.a=function(t){var e=t.children,n=Object(a.useIntl)(),u=o()(x),c=Object(O.c)(),s=Object(O.b)();y(c);var p=function(){s({type:"OPTIN",args:{groupPath:c.path}})},f=Object(d.e)(c.groupName)?Object(d.c)(c.groupName,n):c.groupName;return i.a.createElement(r.Fragment,null,!1===c.optin?i.a.createElement(m.a,{variation:"secondary",onClick:p},i.a.createElement(l.a,{id:"store/product-customizer.add-assembly",values:{name:f}})):i.a.createElement(r.Fragment,null,i.a.createElement("div",{className:"".concat(u.productAssemblyGroupNameRow," flex justify-between items-center")},i.a.createElement("div",{className:"".concat(u.productAssemblyGroupName," ttc-s pv4 c-muted-2 t-small")},f),!1===c.required?i.a.createElement("div",null,i.a.createElement(m.a,{size:"small",collapseRight:!0,variation:"tertiary",onClick:p},i.a.createElement(l.a,{id:"store/product-customizer.remove-assembly",values:{name:f}}))):i.a.createElement("div",{className:"".concat(u.productAssemblyGroupRequiredTag," f7")},i.a.createElement(a.FormattedMessage,{id:"store/product-customizer.required"}))),c.items?Object.values(c.items).map((function(t){return i.a.createElement(E.a,{item:t,key:t.id},i.a.createElement(h,null,e))})):i.a.createElement(E.a,{item:null},e)))}},3:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return o}));var r=n(0),i=n.n(r),a=Object(r.createContext)(null),u=function(t){var e=t.item,n=t.children;return i.a.createElement(a.Provider,{value:e},n)},o=function(){return Object(r.useContext)(a)}},44:function(t,e){t.exports=__RENDER_8_COMPONENTS__["vtex.product-context@0.x/useProduct"]},5:function(t,e){t.exports=__RENDER_8_COMPONENTS__["vtex.css-handles@0.x/useCssHandles"]},58:function(t,e,n){"use strict";n.r(e),function(t){var e=n(9);n.p=Object(e.getPublicPath)("vtex.product-customizer@2.12.1");var r=Object(e.register)((function(){return n(68)}),t,"vtex.product-customizer@2.12.1","vtex.product-customizer@2.x","ProductAssemblyOptions");r.renderHotReload,r.setupHMR}.call(this,n(21)(t))},68:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),a=n(23),u=n(44),o=n.n(u),c=n(1),l=n(8);function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return u=t.done,t},e:function(t){o=!0,a=t},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw a}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d=Object(c.compose)(c.last,Object(c.split)("_")),p=function(t){return Object(c.find)(Object(c.propEq)("id",t))};function f(t,e,n,r,i){return t.reduce((function(t,u){if(!u.composition&&!u.inputValues)return t;var o=r&&i?[].concat(Object(a.a)(i),[{itemId:r,groupId:u.id}]):[];if(u.composition){var s=u.composition.items?function(t,e,n,r){if(!r.composition||!r.composition.items)return;return r.composition.items.reduce((function(i,a){var u=p(a.id)(e.itemMetadata.items);if(!u)return i;var o=u.assemblyOptions.length>0?f(u.assemblyOptions,t,e,a.id,n):null;return i[a.id]={image:u.imageUrl,name:u.name,id:a.id,price:Object(c.pathOr)(0,[a.priceTable,r.id,a.id],t),minQuantity:a.minQuantity,maxQuantity:a.maxQuantity,seller:a.seller,initialQuantity:a.initialQuantity,quantity:a.initialQuantity,children:o},i}),{})}(e,n,o,u):void 0;t[u.id]={id:u.id,minQuantity:u.composition.minQuantity,maxQuantity:u.composition.maxQuantity,groupName:d(u.id),treePath:o,type:Object(l.b)(u),inputValues:u.inputValues,required:u.required,items:s}}else t[u.id]={id:u.id,minQuantity:void 0,maxQuantity:void 0,groupName:d(u.id),treePath:o,type:Object(l.b)(u),inputValues:u.inputValues,required:u.required,items:void 0};return t}),{})}var y=function(){var t=o()(),e=t.product,n=t.selectedItem;return Object(r.useMemo)((function(){if(!n||!e)return null;var t=function(t,e){if(!e||!e.items)return null;var n=p(t.itemId)(e.items);return null==n?void 0:n.assemblyOptions}(n,e.itemMetadata);return t&&0!==t.length?f(t,function(t){var e,n={},r=s(t.priceTable);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.type;n[a]={};var u,o=s(i.values);try{for(o.s();!(u=o.n()).done;){var c=u.value,l=n[a][c.assemblyId]||{};l[c.id]=c.price,n[a][c.assemblyId]=l}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}return n}(e.itemMetadata),e):null}),[e,n])},v=n(29),b=n(6);e.default=function(t){var e=t.children,n=t.initiallyOpened,a=void 0===n?"required":n,u=y();return u?i.a.createElement(r.Fragment,null,Object.keys(u).map((function(t){return i.a.createElement(b.a,{key:t,initiallyOpened:a,assemblyOption:u[t]},i.a.createElement(v.a,{initiallyOpened:a},e))}))):null}}},[[58,"common",0]]]);